{% extends 'base.html' %}
{% block title %}Confirm Salary Deposit{% endblock %}
{% block content %}
<h1>üí∞ Confirm Salary Deposit</h1>

<div class="card" style="max-width: 600px; margin: 2rem auto;">
  <div style="text-align: center; margin-bottom: 2rem;">
    <div style="font-size: 3rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
    <h2 style="margin-bottom: 0.5rem;">Mark Salaries as Deposited?</h2>
    <p style="color: #64748b;">Payroll Period: {{ run.period_start|date:"M d" }} to {{ run.period_end|date:"M d, Y" }}</p>
  </div>

  <div style="background: #fef3c7; border: 1px solid #fbbf24; padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem;">
    <h3 style="margin-bottom: 1rem;">‚ö†Ô∏è Important: This action will:</h3>
    <ul style="margin-left: 1.5rem; line-height: 1.8;">
      <li>Update loan balances (deduct monthly payments)</li>
      <li>Record the deposit date and time</li>
      <li>Mark all payslips as deposited</li>
      <li>Change payroll status to <span class="badge badge-paid">PAID</span></li>
      <li><strong>This cannot be easily undone!</strong></li>
    </ul>
  </div>

  <div style="background: #f0f9ff; border: 1px solid #0ea5e9; padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem;">
    <h3 style="margin-bottom: 1rem;">‚úì Before proceeding, confirm that:</h3>
    <ul style="margin-left: 1.5rem; line-height: 1.8;">
      <li>Bank transfer has been completed</li>
      <li>Bank has confirmed the transaction</li>
      <li>All employees will receive their salaries</li>
      <li>You have reviewed the payslips</li>
    </ul>
  </div>

  <form method="post" style="text-align: center;">
    {% csrf_token %}
    
    <div style="margin-bottom: 1.5rem;">
      <label style="display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 1.1rem;">
        <input type="checkbox" id="confirm-checkbox" required style="width: 20px; height: 20px; margin-right: 10px;">
        <span>I confirm that the bank transfer has been completed</span>
      </label>
    </div>

    <div class="action-buttons" style="justify-content: center;">
      <button 
        type="submit" 
        class="btn btn-success" 
        id="confirm-btn"
        data-confirm-action="mark-paid"
      >
        üí∞ Yes, Mark as Deposited
      </button>
      <a class="btn btn-secondary" href="/payroll/runs/{{ run.id }}/payslips/">
        ‚Üê Cancel
      </a>
    </div>
  </form>
</div>

<script>
  // Enable/disable button based on checkbox
  const checkbox = document.getElementById('confirm-checkbox');
  const confirmBtn = document.getElementById('confirm-btn');
  
  checkbox.addEventListener('change', function() {
    if (this.checked) {
      confirmBtn.disabled = false;
      confirmBtn.style.opacity = '1';
    } else {
      confirmBtn.disabled = true;
      confirmBtn.style.opacity = '0.5';
    }
  });
  
  // Initially disable button
  confirmBtn.disabled = true;
  confirmBtn.style.opacity = '0.5';
</script>

<style>
  input[type="checkbox"] {
    cursor: pointer;
  }
  
  button:disabled {
    cursor: not-allowed;
  }
</style>
{% endblock %}
